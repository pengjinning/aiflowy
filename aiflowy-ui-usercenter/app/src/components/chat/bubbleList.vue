<script setup lang="ts">
import type {
  BubbleListItemProps,
  BubbleListProps,
} from 'vue-element-plus-x/types/BubbleList';

import { ref } from 'vue';
import { BubbleList } from 'vue-element-plus-x';

import { CopyDocument, EditPen, RefreshRight } from '@element-plus/icons-vue';
import { ElAvatar, ElButton } from 'element-plus';

type listType = BubbleListItemProps & {
  key: number;
  role: 'ai' | 'user';
};

const avatar = ref('https://avatars.githubusercontent.com/u/76239030?v=4');
const avartAi = ref(
  'https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png',
);
const messageList: BubbleListProps<listType>['list'] = [
  {
    key: 0,
    role: 'user',
    placement: 'end',
    content: 'å“ˆå“ˆå“ˆï¼Œè®©æˆ‘è¯•è¯•',
    typing: true,
  },
  {
    key: 1,
    role: 'ai',
    placement: 'start',
    content: 'ğŸ’– æ„Ÿè°¢ä½¿ç”¨ Element Plus X ! ä½ çš„æ”¯æŒï¼Œæ˜¯æˆ‘ä»¬å¼€æºçš„æœ€å¼ºåŠ¨åŠ› ~',
    typing: true,
  },
  {
    key: 2,
    role: 'user',
    placement: 'end',
    content: 'å“ˆå“ˆå“ˆï¼Œè®©æˆ‘è¯•è¯•',
    typing: true,
  },
  {
    key: 3,
    role: 'ai',
    placement: 'start',
    content: 'ğŸ’– æ„Ÿè°¢ä½¿ç”¨ Element Plus X ! ä½ çš„æ”¯æŒï¼Œæ˜¯æˆ‘ä»¬å¼€æºçš„æœ€å¼ºåŠ¨åŠ› ~',
    loading: true,
  },
];
</script>

<template>
  <BubbleList :list="messageList" max-height="calc(100vh - 345px)">
    <!-- è‡ªå®šä¹‰å¤´åƒ -->
    <template #avatar="{ item }">
      <ElAvatar :src="item.role === 'ai' ? avartAi : avatar" :size="40" />
    </template>

    <!-- è‡ªå®šä¹‰å¤´éƒ¨ -->
    <template #header="{ item }">
      <span class="text-foreground/50 text-xs">{{
        item.role === 'ai' ? 'ä¸‹åˆ 2:32' : 'ä¸‹åˆ 2:33'
      }}</span>
    </template>

    <!-- è‡ªå®šä¹‰æ°”æ³¡å†…å®¹ -->
    <!-- <template #content="{ item }">
    </template> -->

    <!-- è‡ªå®šä¹‰åº•éƒ¨ -->
    <template #footer="{ item }">
      <div class="flex items-center">
        <template v-if="item.role === 'ai'">
          <ElButton :icon="RefreshRight" link />
          <ElButton :icon="CopyDocument" link />
        </template>
        <template v-else>
          <ElButton :icon="CopyDocument" link />
          <ElButton :icon="EditPen" link />
        </template>
      </div>
    </template>
  </BubbleList>
</template>
